import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# ุชุญููู ุงูุจูุงูุงุช ุงูููุธูุฉ
file_path = "Riyadh_Aqqar.xlsx"
df_villas = pd.read_excel(file_path, sheet_name="Villas (ุงูููู)")
df_apartments = pd.read_excel(file_path, sheet_name="Apartments (ุงูุดูู)")

# ๐ก ุนููุงู ุงููุตุฉ ุงูุชูุงุนููุฉ
st.title("๐ก ุจูุช ุงูุฌุฏุฉ โ ุงุฎุชูุงุฑ ุงูููุฒู ุงููุซุงูู ููุนุงุฆูุฉ ุงูุณุนูุฏูุฉ")
st.write("### ุชุฌูุนุงุช ุงูุนุงุฆูุฉ ูุง ุชูุชูู ุฅูุง ูู ุจูุช ุงูุฌุฏุฉ! โจ")
st.write("ุฎูููุง ููุชุดู ูุนูุง ูู ุนุฏุฏ ุงูุบุฑู ุงูุชู ูุญุชุงุฌูุงุ ููุง ูู ุงููุณุงุญุฉ ุงูููุงุณุจุฉุ")

# ๐น ุงุฎุชูุงุฑ ุนุฏุฏ ุงูุบุฑู ุงููุทููุจุฉ
num_rooms = st.slider("ูู ุนุฏุฏ ุงูุบุฑู ุงูุชู ูุญุชุงุฌูุง ุจูุช ุงูุฌุฏุฉุ", min_value=3, max_value=10, value=7)
st.write(f"๐น ุงุฎุชุฑุช {num_rooms} ุบุฑู ูุจูุช ุงูุฌุฏุฉ!")

# ๐น ุงุฎุชูุงุฑ ูุณุงุญุฉ ุงูุจูุช ุงูููุงุณุจุฉ
space_options = {
    "ุตุบูุฑุฉ (300-400ูยฒ)": (300, 400),
    "ูุชูุณุทุฉ (400-600ูยฒ)": (400, 600),
    "ูุจูุฑุฉ (600-1000ูยฒ)": (600, 1000)
}
selected_space = st.selectbox("ูุง ูู ุงููุณุงุญุฉ ุงูููุงุณุจุฉุ", list(space_options.keys()))
space_range = space_options[selected_space]
st.write(f"๐น ุงุฎุชุฑุช {selected_space} ูุจูุช ุงูุฌุฏุฉ!")

# ๐ ุชุตููุฉ ุงูุจูุงูุงุช ุจูุงุกู ุนูู ุงูุงุฎุชูุงุฑุงุช
df_selected = df_villas[(df_villas['ุนุฏุฏ ุงูุบุฑู'] >= num_rooms) & (df_villas['ุงููุณุงุญุฉ'].between(space_range[0], space_range[1]))]

# ๐น ุงูุชุฃูุฏ ูู ุฃู `ุงููุณุงุญุฉ` ุจูุงูุงุช ุฑูููุฉ ูุฅุฒุงูุฉ ุงูููู ุงููุงุฑุบุฉ
df_selected["ุงููุณุงุญุฉ"] = pd.to_numeric(df_selected["ุงููุณุงุญุฉ"], errors="coerce")
df_selected = df_selected.dropna(subset=["ุงููุณุงุญุฉ"])

# ๐ ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงูููุงุฒู ุงููุชุงุญุฉ
st.write("### ๐ ุงูููุงุฒู ุงููุชุงุญุฉ ุจูุฐู ุงูููุงุตูุงุช:")
st.write(f"๐น ุชู ุงูุนุซูุฑ ุนูู **{df_selected.shape[0]}** ููุฒููุง ูุชุทุงุจู ูุน ุงุฎุชูุงุฑุงุชู!")

# ๐ ุฑุณู ุชูุฒูุน ุนุฏุฏ ุงูุบุฑู
fig, ax = plt.subplots(figsize=(8, 5))
sns.countplot(data=df_selected, x="ุนุฏุฏ ุงูุบุฑู", palette="Blues")
plt.title("ุชูุฒูุน ุนุฏุฏ ุงูุบุฑู ูู ุงูููุงุฒู ุงููุชุงุญุฉ")
plt.xlabel("ุนุฏุฏ ุงูุบุฑู")
plt.ylabel("ุนุฏุฏ ุงูููุงุฒู")
st.pyplot(fig)

# ๐ ุฑุณู ุชูุฒูุน ุงููุณุงุญุงุช ุจุนุฏ ุงูุชุนุฏูู
fig2, ax2 = plt.subplots(figsize=(8, 5))
sns.histplot(df_selected["ุงููุณุงุญุฉ"], bins=30, kde=True, color="blue")
plt.xlabel("ุงููุณุงุญุฉ ุจุงููุชุฑ ุงููุฑุจุน")
plt.ylabel("ุนุฏุฏ ุงูุนูุงุฑุงุช")
plt.title("ุชูุฒูุน ุงููุณุงุญุงุช ูู ุงูููุงุฒู ุงููุชุงุญุฉ")
st.pyplot(fig2)

# ๐ ุนุฑุถ ุฌุฏูู ุงูููุงุฒู ุงููุชุงุญุฉ ูุน ุงูุฃุณุนุงุฑ
st.write("### ๐ก ุชูุงุตูู ุงูููุงุฒู ุงููุชุงุญุฉ:")
st.dataframe(df_selected[['ุนุฏุฏ ุงูุบุฑู', 'ุงููุณุงุญุฉ', 'ุงูุณุนุฑ ุงูุฅุฌูุงูู', 'ุงูุณุนุฑ ุงููุชุฑ']].sort_values(by='ุงูุณุนุฑ ุงูุฅุฌูุงูู'))

# ๐ ุฑุณุงูุฉ ุฎุชุงููุฉ
st.success("๐ ุงุณุชูุชุน ุจุชุญููู ุงูุจูุงูุงุช ูุงุฎุชูุงุฑ ุจูุช ุงูุฌุฏุฉ ุงููุซุงูู! ูุง ุชูุณู ุฃู ุชุดุงุฑููุง ุฐูุฑูุงุชู ุงูุฌูููุฉ ุนู ุจูุช ุงูุฌุฏุฉ ๐ตโค๏ธ")
